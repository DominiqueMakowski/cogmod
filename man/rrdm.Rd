% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rdm.R
\name{rrdm}
\alias{rrdm}
\title{Simulate from the Two-Accumulator Racing Diffusion Model (RDM)}
\usage{
rrdm(n, vzero, vone, k, A, ndt)
}
\arguments{
\item{n}{Number of trials to simulate. Must be a positive integer.}

\item{vzero}{Drift rate for the first accumulator. Must be a single non-negative number.}

\item{vone}{Drift rate for the second accumulator. Must be a single non-negative number.
At least one of \code{vzero} or \code{vone} must be positive.}

\item{k}{Threshold parameter, defined as \code{k = b - A}, where \code{b} is the
decision threshold and \code{A} is the maximum starting point. Must be a single
positive number.}

\item{A}{Maximum starting point parameter. The starting point \code{z} for each
accumulator on each trial is drawn from \code{Uniform(0, A)}. Must be a single
positive number.}

\item{ndt}{Non-decision time (encoding and motor time offset). Must be a
single non-negative number.}
}
\value{
A data frame with \code{n} rows and two columns:
\item{rt}{The simulated reaction time (minimum finishing time across the two accumulators).}
\item{choice}{The index of the winning accumulator (1 for \code{vzero}, 2 for \code{vone}).}
}
\description{
Simulates choice reaction times from a two-accumulator Racing Diffusion Model (RDM).
This is a specialized version where exactly two accumulators race towards a
common threshold. The model assumes variability in the starting point of the
diffusion process, drawn from a uniform distribution. This version is optimized
for performance using vectorized operations and allows one (but not both)
drift rate to be zero.
}
\details{
The RDM implemented here follows the formulation where the two accumulators
have drift rates \code{vzero} and \code{vone}. The diffusion process starts at a point \code{z} drawn
from \code{Uniform(0, A)}. The process terminates when either accumulator reaches
a threshold \code{b}. The parameter \code{k} is defined as \code{k = b - A}, representing
the distance from the maximum starting point \code{A} to the threshold \code{b}.
Therefore, the effective distance to threshold for a given trial is
\code{alpha = b - z = k + A - z}.

The finishing time for a single accumulator, given its drift rate \code{v}, \code{k}, \code{A}, and \code{ndt},
is simulated by:
\enumerate{
\item Sampling a starting point \code{z ~ Uniform(0, A)}.
\item Calculating the distance \code{alpha = k + A - z}.
\item If \code{v > 0}, simulating the time to reach \code{alpha} from an Inverse Gaussian distribution
with mean \code{alpha / v} and shape \code{alpha^2}. This simulation uses an
internal implementation based on Michael et al. (1976).
\item If \code{v = 0}, the finishing time is considered infinite (\code{Inf}).
\item Adding the non-decision time \code{ndt} to finite finishing times.
}

The function simulates this process for both accumulators using vectorized operations.
The accumulator that finishes first determines the choice (1 for \code{vzero}, 2 for \code{vone})
and the reaction time (RT) for that trial. If one drift rate is zero, the
accumulator with the positive drift rate will always win.

This implementation is based on the description and parameters used in:
Tillman, G., Van Zandt, T., & Logan, G. D. (2020). Sequential sampling models
without random between-trial variability: The racing diffusion model of
speeded decision making. \emph{Psychonomic Bulletin & Review}, \emph{27}, 911-936.
\doi{10.3758/s13423-020-01738-8} (specifically matching the \code{WaldA} component
used within their RDM simulation).
}
\examples{
# Basic simulation with two positive drifts
sim_data_pos <- rrdm(n = 1000, vzero = 0.8, vone = 0.6, k = 0.5, A = 0.2, ndt = 0.15)
head(sim_data_pos)
mean(sim_data_pos$choice == 1) # Proportion of choices for accumulator 1
hist(sim_data_pos$rt, breaks = 30, main = "Simulated RDM RTs (v>0)")

# Simulation with one drift rate = 0
sim_data_zero <- rrdm(n = 1000, vzero = 0.8, vone = 0, k = 0.5, A = 0.2, ndt = 0.15)
head(sim_data_zero)
mean(sim_data_zero$choice == 1) # Should be 1 (or very close due to floating point)
hist(sim_data_zero$rt, breaks = 30, main = "Simulated RDM RTs (vone=0)")
# Note: RT distribution differs from shifted_wald due to starting point variability

}
\references{
\itemize{
\item Michael, J. R., Schucany, W. R., & Haas, R. W. (1976). Generating Random Variates Using
Transformations with Multiple Roots. \emph{The American Statistician}, \emph{30}(2), 88–90. \doi{10.2307/2683801}
\item Tillman, G., Van Zandt, T., & Logan, G. D. (2020). Sequential sampling models
without random between-trial variability: The racing diffusion model of
speeded decision making. \emph{Psychonomic Bulletin & Review}, \emph{27}, 911-936.
\doi{10.3758/s13423-020-01738-8}
\item Folks, J. L., & Chhikara, R. S. (1978). The inverse Gaussian distribution and its
statistical application—a review. \emph{Journal of the Royal Statistical Society Series B:
Statistical Methodology}, \emph{40}(3), 263-275.
}
}
\seealso{
\code{rshifted_wald}
}
