<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Linear Ballistic Accumulator (LBA) Model Simulation — rlba • cogmod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear Ballistic Accumulator (LBA) Model Simulation — rlba"><meta name="description" content="Simulates random draws (reaction times and choices) from a two-choice Linear Ballistic Accumulator (LBA) model.
In this parametrization, each accumulator has its own independent drift rate distribution:
Accumulator 0 has drift drawn from N(driftzero, sigmazero^2).
Accumulator 1 has drift drawn from N(driftone, sigmaone^2).


For each trial, drift rates are sampled on an individual basis until at least one of the two is positive.
The starting point for each accumulator is sampled uniformly from (0, sigmabias). The decision threshold is defined as sigmabias + bs.
The decision time for an accumulator is calculated as (b - start)/drift, and if its drift is not positive, its decision time is set to Inf.
The winning accumulator (the one whose decision time is minimal) determines the response, and the final reaction time is the sum of its decision time
and a fixed non-decision time (ndt)."><meta property="og:description" content="Simulates random draws (reaction times and choices) from a two-choice Linear Ballistic Accumulator (LBA) model.
In this parametrization, each accumulator has its own independent drift rate distribution:
Accumulator 0 has drift drawn from N(driftzero, sigmazero^2).
Accumulator 1 has drift drawn from N(driftone, sigmaone^2).


For each trial, drift rates are sampled on an individual basis until at least one of the two is positive.
The starting point for each accumulator is sampled uniformly from (0, sigmabias). The decision threshold is defined as sigmabias + bs.
The decision time for an accumulator is calculated as (b - start)/drift, and if its drift is not positive, its decision time is set to Inf.
The winning accumulator (the one whose decision time is minimal) determines the response, and the final reaction time is the sum of its decision time
and a fixed non-decision time (ndt)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cogmod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.19</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rt_models.html">RT-only Models</a></li>
    <li><a class="dropdown-item" href="../articles/subjective_ratings.html">Subjective Ratings</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/DominiqueMakowski/cogmod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Linear Ballistic Accumulator (LBA) Model Simulation</h1>
      <small class="dont-index">Source: <a href="https://github.com/DominiqueMakowski/cogmod/blob/main/R/lba.R"><code>R/lba.R</code></a>, <a href="https://github.com/DominiqueMakowski/cogmod/blob/main/R/lba_brms.R"><code>R/lba_brms.R</code></a></small>
      <div class="d-none name"><code>rlba.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates random draws (reaction times and choices) from a two-choice Linear Ballistic Accumulator (LBA) model.</p>
<p>In this parametrization, each accumulator has its own independent drift rate distribution:</p><ul><li><p>Accumulator 0 has drift drawn from N(driftzero, sigmazero^2).</p></li>
<li><p>Accumulator 1 has drift drawn from N(driftone, sigmaone^2).</p></li>
</ul><p>For each trial, drift rates are sampled on an individual basis until at least one of the two is positive.
The starting point for each accumulator is sampled uniformly from (0, sigmabias). The decision threshold is defined as sigmabias + bs.
The decision time for an accumulator is calculated as (b - start)/drift, and if its drift is not positive, its decision time is set to Inf.
The winning accumulator (the one whose decision time is minimal) determines the response, and the final reaction time is the sum of its decision time
and a fixed non-decision time (ndt).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rlba</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  driftzero <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  driftone <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sigmazero <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sigmaone <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sigmabias <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  bs <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  ndt <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dlba</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  driftzero <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  driftone <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sigmazero <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sigmaone <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sigmabias <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  bs <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  ndt <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lba_lpdf_expose</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lba_stanvars</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lba</span><span class="op">(</span></span>
<span>  link_mu <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  link_driftone <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  link_sigmazero <span class="op">=</span> <span class="st">"softplus"</span>,</span>
<span>  link_sigmaone <span class="op">=</span> <span class="st">"softplus"</span>,</span>
<span>  link_sigmabias <span class="op">=</span> <span class="st">"softplus"</span>,</span>
<span>  link_bs <span class="op">=</span> <span class="st">"softplus"</span>,</span>
<span>  link_tau <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>  link_minrt <span class="op">=</span> <span class="st">"identity"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">log_lik_lba</span><span class="op">(</span><span class="va">i</span>, <span class="va">prep</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">posterior_predict_lba</span><span class="op">(</span><span class="va">i</span>, <span class="va">prep</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">posterior_epred_lba</span><span class="op">(</span><span class="va">prep</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of simulated trials. Must be a positive integer.</p></dd>


<dt id="arg-driftzero">driftzero<a class="anchor" aria-label="anchor" href="#arg-driftzero"></a></dt>
<dd><p>Mean drift rate for the first accumulator (accumulator 0). Range: (-Inf, Inf).</p></dd>


<dt id="arg-driftone">driftone<a class="anchor" aria-label="anchor" href="#arg-driftone"></a></dt>
<dd><p>Mean drift rate for the second accumulator (accumulator 1). Range: (-Inf, Inf).</p></dd>


<dt id="arg-sigmazero">sigmazero<a class="anchor" aria-label="anchor" href="#arg-sigmazero"></a></dt>
<dd><p>Standard deviation of the drift rate for the first accumulator. Must be positive. Range: (0, Inf).</p></dd>


<dt id="arg-sigmaone">sigmaone<a class="anchor" aria-label="anchor" href="#arg-sigmaone"></a></dt>
<dd><p>Standard deviation of the drift rate for the second accumulator. Must be positive. Range: (0, Inf).</p></dd>


<dt id="arg-sigmabias">sigmabias<a class="anchor" aria-label="anchor" href="#arg-sigmabias"></a></dt>
<dd><p>Maximum starting point for the uniform distribution of starting evidence (0, sigmabias). Must be positive.
Range: (0, Inf). Default: 0.5.</p></dd>


<dt id="arg-bs">bs<a class="anchor" aria-label="anchor" href="#arg-bs"></a></dt>
<dd><p>Additional amount beyond <code>sigmabias</code> to set the decision threshold (b = sigmabias + bs). Must be positive.
Range: (0, Inf). Default: 0.5.</p></dd>


<dt id="arg-ndt">ndt<a class="anchor" aria-label="anchor" href="#arg-ndt"></a></dt>
<dd><p>Non-decision time, representing processes such as encoding and motor response. Must be non-negative.
Range: [0, Inf). Default: 0.3.</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum iterations allowed (per trial) for resampling drift rates if both
are non-positive. Default: 100.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The observed reaction time (RT). Must be greater than <code>ndt</code>.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>The decision indicator (0 or 1). 0 for choice 0, 1 for choice 1.</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Logical; if TRUE, returns the log-density. Default: FALSE.</p></dd>


<dt id="arg-link-mu-link-driftone-link-sigmazero-link-sigmaone-link-sigmabias-link-bs-link-tau-link-minrt">link_mu, link_driftone, link_sigmazero, link_sigmaone, link_sigmabias, link_bs, link_tau, link_minrt<a class="anchor" aria-label="anchor" href="#arg-link-mu-link-driftone-link-sigmazero-link-sigmaone-link-sigmabias-link-bs-link-tau-link-minrt"></a></dt>
<dd><p>Link functions for the parameters.</p></dd>


<dt id="arg-i-prep">i, prep<a class="anchor" aria-label="anchor" href="#arg-i-prep"></a></dt>
<dd><p>For brms' functions to run: index of the observation and a <code>brms</code> preparation object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Psychological Interpretation:</strong></p><ul><li><p><strong>Drift Rate (<code>driftzero</code>, <code>driftone</code>)</strong>: Reflects the rate at which evidence accumulates for each choice. Higher drift rates indicate faster
evidence accumulation and a higher likelihood of selecting the corresponding choice. Differences in drift rates between accumulators
can represent differences in preference, difficulty, or bias between the two options.</p></li>
<li><p><strong>Drift Rate Variability (<code>sigmazero</code>, <code>sigmaone</code>)</strong>: Captures trial-to-trial variability in the evidence accumulation process.
Higher variability indicates less consistent evidence accumulation, leading to greater variability in reaction times and choices.</p></li>
<li><p><strong>Start Point Variability (<code>sigmabias</code>)</strong>: Represents the range of initial evidence levels for each accumulator. Larger values of <code>sigmabias</code> introduce
more variability in reaction times, as the starting point can vary more widely between trials.</p></li>
<li><p><strong>Threshold (<code>b = sigmabias + bs</code>)</strong>: Boundary separation (<code>bs</code>). Represents the amount of evidence required to make a decision. Higher thresholds lead to longer reaction times
but more accurate decisions, as more evidence is required before a choice is made.</p></li>
<li><p><strong>Non-Decision Time (<code>ndt</code>)</strong>: Accounts for processes unrelated to evidence accumulation, such as sensory encoding and motor response.
This parameter shifts all reaction times by a constant amount.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Brown, S. D., &amp; Heathcote, A. (2008). The simplest complete model of choice response time: Linear ballistic accumulation.
<em>Cognitive Psychology</em>, <em>57</em>(3), 153-178. <a href="https://doi.org/10.1016/j.cogpsych.2007.12.002" class="external-link">doi:10.1016/j.cogpsych.2007.12.002</a></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rlba</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, driftzero <span class="op">=</span> <span class="fl">3</span>, driftone <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>           sigmazero <span class="op">=</span> <span class="fl">0.5</span>, sigmaone <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>           sigmabias <span class="op">=</span> <span class="fl">0.5</span>, bs <span class="op">=</span> <span class="fl">0.5</span>, ndt <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="fl">50</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="fl">50</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rlba-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can expose the lpdf function as follows:</span></span></span>
<span class="r-in"><span><span class="co"># lba_lpdf &lt;- lba_lpdf_expose()</span></span></span>
<span class="r-in"><span><span class="co"># lba_lpdf(...)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dominique Makowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

