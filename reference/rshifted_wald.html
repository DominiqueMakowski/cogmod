<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Shifted Wald (Shifted Inverse Gaussian) Model Functions — rshifted_wald • cogmod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shifted Wald (Shifted Inverse Gaussian) Model Functions — rshifted_wald"><meta name="description" content="Density, distribution function, and random generation for the Shifted Wald
distribution, also known as the Shifted Inverse Gaussian distribution. This
distribution is commonly used in modeling reaction times in cognitive tasks.
It is characterized by a drift rate (nu), a decision threshold (alpha),
and a non-decision time (ndt).
Functions:
rshifted_wald(): Simulates random draws from the Shifted Wald model.
dshifted_wald(): Computes the density (likelihood) of the Shifted Wald distribution.
pshifted_wald(): Computes the cumulative distribution function (CDF).
qshifted_wald(): Computes the quantile function (inverse CDF).

"><meta property="og:description" content="Density, distribution function, and random generation for the Shifted Wald
distribution, also known as the Shifted Inverse Gaussian distribution. This
distribution is commonly used in modeling reaction times in cognitive tasks.
It is characterized by a drift rate (nu), a decision threshold (alpha),
and a non-decision time (ndt).
Functions:
rshifted_wald(): Simulates random draws from the Shifted Wald model.
dshifted_wald(): Computes the density (likelihood) of the Shifted Wald distribution.
pshifted_wald(): Computes the cumulative distribution function (CDF).
qshifted_wald(): Computes the quantile function (inverse CDF).

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cogmod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/DominiqueMakowski/cogmod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Shifted Wald (Shifted Inverse Gaussian) Model Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/DominiqueMakowski/cogmod/blob/main/R/shifted_wald.R"><code>R/shifted_wald.R</code></a>, <a href="https://github.com/DominiqueMakowski/cogmod/blob/main/R/shifted_wald_brms.R"><code>R/shifted_wald_brms.R</code></a></small>
      <div class="d-none name"><code>rshifted_wald.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Density, distribution function, and random generation for the Shifted Wald
distribution, also known as the Shifted Inverse Gaussian distribution. This
distribution is commonly used in modeling reaction times in cognitive tasks.
It is characterized by a drift rate (<code>nu</code>), a decision threshold (<code>alpha</code>),
and a non-decision time (<code>ndt</code>).</p>
<p>Functions:</p><ul><li><p><code>rshifted_wald()</code>: Simulates random draws from the Shifted Wald model.</p></li>
<li><p><code>dshifted_wald()</code>: Computes the density (likelihood) of the Shifted Wald distribution.</p></li>
<li><p><code>pshifted_wald()</code>: Computes the cumulative distribution function (CDF).</p></li>
<li><p><code>qshifted_wald()</code>: Computes the quantile function (inverse CDF).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rshifted_wald</span><span class="op">(</span><span class="va">n</span>, nu <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, ndt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dshifted_wald</span><span class="op">(</span><span class="va">x</span>, nu <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, ndt <span class="op">=</span> <span class="fl">0.2</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shifted_wald_lpdf_expose</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shifted_wald_stanvars</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">shifted_wald</span><span class="op">(</span></span>
<span>  link_mu <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>  link_alpha <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>  link_tau <span class="op">=</span> <span class="st">"logit"</span>,</span>
<span>  link_minrt <span class="op">=</span> <span class="st">"identity"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">log_lik_shifted_wald</span><span class="op">(</span><span class="va">i</span>, <span class="va">prep</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">posterior_predict_shifted_wald</span><span class="op">(</span><span class="va">i</span>, <span class="va">prep</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">posterior_epred_shifted_wald</span><span class="op">(</span><span class="va">prep</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of observations. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p></dd>


<dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>Drift rate. Must be positive. Represents the average speed of evidence accumulation.
Range: (0, Inf).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Decision threshold. Must be positive. Represents the amount of evidence needed
to make a decision. Range: (0, Inf).</p></dd>


<dt id="arg-ndt">ndt<a class="anchor" aria-label="anchor" href="#arg-ndt"></a></dt>
<dd><p>Non-decision time (shift parameter). Must be non-negative. Represents time for
processes like stimulus encoding and response execution. Range: [0, Inf).</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Vector of quantiles (observed reaction times).</p></dd>


<dt id="arg-log">log<a class="anchor" aria-label="anchor" href="#arg-log"></a></dt>
<dd><p>Logical; if TRUE, probabilities p are given as log(p).</p></dd>


<dt id="arg-link-mu-link-alpha-link-tau-link-minrt">link_mu, link_alpha, link_tau, link_minrt<a class="anchor" aria-label="anchor" href="#arg-link-mu-link-alpha-link-tau-link-minrt"></a></dt>
<dd><p>Link functions.</p></dd>


<dt id="arg-i-prep">i, prep<a class="anchor" aria-label="anchor" href="#arg-i-prep"></a></dt>
<dd><p>For brms' functions to run: index of the observation and a <code>brms</code> preparation object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>rshifted_wald</code> returns a vector of random deviates.</p>
<p><code>dshifted_wald</code> returns the density (PDF).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Shifted Wald distribution describes the time it takes for a Wiener diffusion
process starting at 0 to reach a threshold <code>alpha</code> &gt; 0, given a positive drift
rate <code>nu</code> &gt; 0. The resulting time is then shifted by a non-decision time <code>ndt</code> &gt;= 0.</p>
<p>The distribution is mathematically equivalent to shifting an Inverse Gaussian
distribution with mean <code>mu = alpha / nu</code> and shape parameter <code>lambda = alpha^2</code>.
That is, <code>ShiftedWald(nu, alpha, ndt) = InverseGaussian(mean = alpha/nu, shape = alpha^2) + ndt</code>.</p>
<p>The random generation algorithm implemented here is based on the method described
by Michael, Schucany, and Haas (1976), as used in the <code>statmod</code> package.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Michael, J. R., Schucany, W. R., &amp; Haas, R. W. (1976). Generating Random Variates Using
Transformations with Multiple Roots. <em>The American Statistician</em>, <em>30</em>(2), 88–90. <a href="https://doi.org/10.2307/2683801" class="external-link">doi:10.2307/2683801</a></p></li>
<li><p>Anders, R., Alario, F., &amp; Van Maanen, L. (2016). The shifted Wald distribution for
response time data analysis. <em>Psychological Methods</em>, <em>21</em>(3), 309–327. <a href="https://doi.org/10.1037/met0000063" class="external-link">doi:10.1037/met0000063</a></p></li>
<li><p>Matzke, D., &amp; Wagenmakers, E. J. (2009). Psychological interpretation of the ex-Gaussian
and shifted Wald parameters: A diffusion model analysis. <em>Psychonomic Bulletin &amp; Review</em>,
<em>16</em>(5), 798–817. <a href="https://doi.org/10.3758/PBR.16.5.798" class="external-link">doi:10.3758/PBR.16.5.798</a></p></li>
<li><p>Folks, J. L., &amp; Chhikara, R. S. (1978). The inverse Gaussian distribution and its
statistical application—a review. <em>Journal of the Royal Statistical Society Series B:
Statistical Methodology</em>, <em>40</em>(3), 263-275.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>dshifted_wald</code>, <code>pshifted_wald</code>, <code>qshifted_wald</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate 1000 RTs</span></span></span>
<span class="r-in"><span><span class="va">rts</span> <span class="op">&lt;-</span> <span class="fu">rshifted_wald</span><span class="op">(</span><span class="fl">1000</span>, nu <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, ndt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">rts</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"Simulated Shifted Wald RTs"</span>, xlab <span class="op">=</span> <span class="st">"Reaction Time"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="rshifted_wald-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># You can expose the lpdf function as follows:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cmdstanr"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sw_lpdf</span> <span class="op">&lt;-</span> <span class="fu">shifted_wald_lpdf_expose</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Example call (using nu, alpha, ndt for clarity, map to mu, alpha, tau*minrt)</span></span></span>
<span class="r-in"><span>  <span class="fu">sw_lpdf</span><span class="op">(</span>Y <span class="op">=</span> <span class="fl">0.5</span>, mu <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">0.5</span>, minrt <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="co"># ndt = 0.2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example brms formula using shifted_wald family</span></span></span>
<span class="r-in"><span><span class="co"># bf(rt ~ condition + (1|subject),</span></span></span>
<span class="r-in"><span><span class="co">#    alpha ~ 1,</span></span></span>
<span class="r-in"><span><span class="co">#    tau ~ condition,</span></span></span>
<span class="r-in"><span><span class="co">#    minrt ~ 1,  # Often fixed or estimated per subject</span></span></span>
<span class="r-in"><span><span class="co">#    family = shifted_wald())</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dominique Makowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

