<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cognitive Models for Subjective Scales and Decision Making Tasks in R • cogmod</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Cognitive Models for Subjective Scales and Decision Making Tasks in R">
<meta name="description" content="A collection of tools for cognitive modeling, i.e., to model data from subjective (Likert or analog) scales and decision making tasks (with reaction times and choice data). These cognitive models can be implemented under a Bayesian framework with `brms`.">
<meta property="og:description" content="A collection of tools for cognitive modeling, i.e., to model data from subjective (Likert or analog) scales and decision making tasks (with reaction times and choice data). These cognitive models can be implemented under a Bayesian framework with `brms`.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cogmod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.17</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/rt_models.html">RT-only Models</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/DominiqueMakowski/cogmod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="cogmod">cogmod<a class="anchor" aria-label="anchor" href="#cogmod"></a>
</h1></div>
<p><a href="https://dominiquemakowski.github.io/cogmod/" class="external-link"><img src="https://img.shields.io/badge/documentation-cogmod-orange.svg?colorB=E91E63" alt="Documentation"></a> <a href="https://dominiquemakowski.github.io/cogmod/reference/index.html" class="external-link"><img src="https://img.shields.io/badge/models-list-orange.svg?colorB=2196F3" alt="Models"></a></p>
<p><em>Cognitive Models for Subjective Scales and Decision Making Tasks in R</em></p>
<div class="section level2">
<h2 id="status">Status<a class="anchor" aria-label="anchor" href="#status"></a>
</h2>
<div class="float">
<img src="https://img.shields.io/badge/status-WIP-orange.svg" alt="Status"><div class="figcaption">Status</div>
</div>
<p><strong>This package is very much totally exploratory - currently made for my own needs.</strong> It’s not meant to be stable and robust at this stage. Use at your own risks.</p>
<ul>
<li>If you have suggestions for improvement, please get in touch!</li>
<li>I’ve been seeking the best way to implement various sequential models for a long time, initially trying and <a href="https://github.com/DominiqueMakowski/easyRT" class="external-link">failing in R</a>, then developing a lot of hopes for a Julia solution - but that’s not there <em>yet</em>, so I’m back at making some new attempts in R.
<ul>
<li>If you are interested in Sequential Sampling Models, see this amazing <a href="https://github.com/itsdfish/SequentialSamplingModels.jl" class="external-link">Julia package</a>
</li>
<li>See also this attempt at <a href="https://dominiquemakowski.github.io/CognitiveModels/" class="external-link"><strong>creating tutorials</strong></a>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"DominiqueMakowski/cogmod"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="available-distributions">Available Distributions<a class="anchor" aria-label="anchor" href="#available-distributions"></a>
</h2>
<div class="section level3">
<h3 id="choco-model">CHOCO Model<a class="anchor" aria-label="anchor" href="#choco-model"></a>
</h3>
<p>The <a href="https://dominiquemakowski.github.io/cogmod/reference/rchoco.html" class="external-link"><strong>Choice-Confidence (CHOCO)</strong></a> model is useful to model data from subjective ratings, such as Likert-type or analog scales, in which the left and the right side correspond to different processes or higher order categorical responses (e.g., “disagree” vs. “agree”, “true” vs. “false”). They can be used to jointly model choice (left or right) and confidence (the degree of left or right).</p>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DominiqueMakowski/cogmod">cogmod</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate data using rchoco() with two parameter sets</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rchoco.html">rchoco</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5000</span>, confright <span class="op">=</span> <span class="fl">0.8</span>, confleft <span class="op">=</span> <span class="fl">0.7</span>, pex <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rchoco.html">rchoco</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5000</span>, confright <span class="op">=</span> <span class="fl">0.3</span>, confleft <span class="op">=</span> <span class="fl">0.3</span>, pex <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rchoco.html">rchoco</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5000</span>, confright <span class="op">=</span> <span class="fl">0.3</span>, confleft <span class="op">=</span> <span class="fl">0.3</span>, pex <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>               precright <span class="op">=</span> <span class="fl">1.5</span>, precleft <span class="op">=</span> <span class="fl">1.5</span>, pmid <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine data into a single data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span>, <span class="va">df3</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"confright = 0.5, confleft = 0.4, pex = 0.2"</span>,</span>
<span>    <span class="st">"confright = 0.7, confleft = 0.6, pex = 0.1"</span>,</span>
<span>    <span class="st">"confright = 0.3, confleft = 0.3, pex = 0.1"</span></span>
<span>  <span class="op">)</span>, each <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.8</span>, position <span class="op">=</span> <span class="st">"identity"</span>, bins <span class="op">=</span> <span class="fl">70</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"CHOCO Distribution"</span>, x <span class="op">=</span> <span class="st">"Value"</span>, y <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">"Parameters"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E91E63"</span>, <span class="st">"#9C27B0"</span>, <span class="st">"#FF9800"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="reference/figures/unnamed-chunk-2-1.png"></p>
</div>
<div class="section level3">
<h3 id="beta-gate">Beta-Gate<a class="anchor" aria-label="anchor" href="#beta-gate"></a>
</h3>
<p><img src="reference/figures/betagate.png"></p>
</div>
<div class="section level3">
<h3 id="lnr-model">LNR Model<a class="anchor" aria-label="anchor" href="#lnr-model"></a>
</h3>
<p>The Log-Normal Race (LNR) model is useful for modeling reaction times and errors in decision-making tasks. The model assumes that each accumulator draws a value from a LogNormal distribution (shifted by a non-decision time τ). The winning accumulator (minimum draw) determines the observed reaction time and choice.</p>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data using rlnr()</span></span>
<span><span class="va">lnr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rlnr.html">rlnr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5000</span>, nuzero <span class="op">=</span> <span class="fl">1</span>, nuone <span class="op">=</span> <span class="fl">0.5</span>, sigmazero <span class="op">=</span> <span class="fl">1</span>, sigmaone <span class="op">=</span> <span class="fl">0.5</span>, ndt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create histograms for each choice</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">lnr_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.8</span>, position <span class="op">=</span> <span class="st">"identity"</span>, bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"LogNormal Race Model"</span>, x <span class="op">=</span> <span class="st">"Reaction Time"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>, fill <span class="op">=</span> <span class="st">"Choice"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4CAF50"</span>, <span class="st">"#FF5722"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="reference/figures/unnamed-chunk-5-1.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="usage-with-brms">Usage with <code>brms</code>
<a class="anchor" aria-label="anchor" href="#usage-with-brms"></a>
</h2>
<div class="section level3">
<h3 id="subjective-ratings">Subjective Ratings<a class="anchor" aria-label="anchor" href="#subjective-ratings"></a>
</h3>
<div class="section level4">
<h4 id="simulate-data">Simulate Data<a class="anchor" aria-label="anchor" href="#simulate-data"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/easystats/" class="external-link">easystats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/cmdstanr/" class="external-link">cmdstanr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">x</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                   score <span class="op">=</span> <span class="fu"><a href="reference/rchoco.html">rchoco</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, p <span class="op">=</span> <span class="fl">0.4</span> <span class="op">+</span> <span class="va">x</span> <span class="op">/</span> <span class="fl">2</span>, confright <span class="op">=</span> <span class="fl">0.4</span> <span class="op">+</span> <span class="va">x</span> <span class="op">/</span> <span class="fl">3</span>, </span>
<span>                                  confleft <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">x</span>, pex <span class="op">=</span> <span class="fl">0.03</span>, bex <span class="op">=</span> <span class="fl">0.6</span>, pmid <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">100</span>, fill <span class="op">=</span> <span class="st">"#2196F3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rating Distribution"</span>, x <span class="op">=</span> <span class="st">"Score"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-6-1.png"></p>
</div>
<div class="section level4">
<h4 id="zoib-model">ZOIB Model<a class="anchor" aria-label="anchor" href="#zoib-model"></a>
</h4>
<p>The Zero-One Inflated Beta (ZOIB) model assumes that the data can be modeled as a mixture of two logistic regression processes for the boundary values (0 and 1) and a beta regression process for the continuous proportions in-between.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">score</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">phi</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">zoi</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">coi</span> <span class="op">~</span> <span class="va">x</span>, </span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">zero_one_inflated_beta</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_zoib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">zero_one_inflated_beta</a></span><span class="op">(</span><span class="op">)</span>, init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_zoib</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_zoib</span>, <span class="st">"loo"</span><span class="op">)</span>  <span class="co"># For later model comparison</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_zoib</span>, file <span class="op">=</span> <span class="st">"man/figures/m_zoib.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="xbx-model">XBX Model<a class="anchor" aria-label="anchor" href="#xbx-model"></a>
</h4>
<p><a href="https://arxiv.org/abs/2409.07233" class="external-link">Kosmidis &amp; Zeileis (2024)</a> introduce a generalization of the classic beta regression model with extended support [0, 1]. Specifically, the extended-support beta distribution (<code>xbeta</code>) leverages an underlying symmetric four-parameter beta distribution with exceedence parameter nu to obtain support [-nu, 1 + nu] that is subsequently censored to [0, 1] in order to obtain point masses at the boundary values 0 and 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">score</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">phi</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">kappa</span> <span class="op">~</span> <span class="va">x</span>, </span>
<span>  family <span class="op">=</span> <span class="fu">xbeta</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_xbx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu">xbeta</span><span class="op">(</span><span class="op">)</span>, init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_xbx</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_xbx</span>, <span class="st">"loo"</span><span class="op">)</span>  <span class="co"># For later model comparison</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_xbx</span>, file <span class="op">=</span> <span class="st">"man/figures/m_xbx.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="beta-gate-model">Beta-Gate Model<a class="anchor" aria-label="anchor" href="#beta-gate-model"></a>
</h4>
<p>The <a href="https://dominiquemakowski.github.io/cogmod/reference/rbetagate.html" class="external-link"><strong>Beta-Gate model</strong></a> corresponds to a reparametrized Ordered Beta model (<a href="https://doi.org/10.1017/pan.2022.20" class="external-link">Kubinec, 2023</a>). In this model, observed 0s and 1s represent instances where the underlying continuous response tendency fell beyond lower or upper boundary points (‘gates’).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">score</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">phi</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">pex</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">bex</span> <span class="op">~</span> <span class="va">x</span>, </span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rbetagate.html">betagate</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_betagate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="reference/rbetagate.html">betagate</a></span><span class="op">(</span><span class="op">)</span>, stanvars <span class="op">=</span> <span class="fu"><a href="reference/rbetagate.html">betagate_stanvars</a></span><span class="op">(</span><span class="op">)</span>, init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_betagate</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_betagate</span>, <span class="st">"loo"</span><span class="op">)</span>  <span class="co"># For later model comparison</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_betagate</span>, file <span class="op">=</span> <span class="st">"man/figures/m_betagate.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="choco-model-1">CHOCO Model<a class="anchor" aria-label="anchor" href="#choco-model-1"></a>
</h4>
<p>See the <a href="https://dominiquemakowski.github.io/cogmod/reference/rchoco.html" class="external-link"><strong>documentation</strong></a> of the Choice-Confidence (CHOCO).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">score</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">confright</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">confleft</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">precright</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">precleft</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">pex</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  <span class="va">bex</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>  pmid <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rchoco.html">choco</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_choco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="reference/rchoco.html">choco</a></span><span class="op">(</span><span class="op">)</span>, stanvars <span class="op">=</span> <span class="fu"><a href="reference/rchoco.html">choco_stanvars</a></span><span class="op">(</span><span class="op">)</span>, init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_choco</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_choco</span>, <span class="st">"loo"</span><span class="op">)</span>  <span class="co"># For later model comparison</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_choco</span>, file <span class="op">=</span> <span class="st">"man/figures/m_choco.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h4>
<p>We can compare these models together using the <code>loo</code> package, which shows that CHOCO provides a significantly better fit than the other models.</p>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_zoib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_zoib.rds"</span><span class="op">)</span></span>
<span><span class="va">m_xbx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_xbx.rds"</span><span class="op">)</span></span>
<span><span class="va">m_betagate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_betagate.rds"</span><span class="op">)</span></span>
<span><span class="va">m_choco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_choco.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">m_zoib</span>, <span class="va">m_xbx</span>, <span class="va">m_betagate</span>, <span class="va">m_choco</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parameters</span><span class="op">(</span>include_ENP <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Fixed Effects</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>Name       <span class="sc">|</span>   LOOIC <span class="sc">|</span>  ENP <span class="sc">|</span>   ELPD <span class="sc">|</span> Difference <span class="sc">|</span> Difference_SE <span class="sc">|</span>      p</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>m_choco    <span class="sc">|</span> <span class="sc">-</span><span class="fl">770.65</span> <span class="sc">|</span> <span class="fl">8.93</span> <span class="sc">|</span> <span class="fl">385.33</span> <span class="sc">|</span>       <span class="fl">0.00</span> <span class="sc">|</span>          <span class="fl">0.00</span> <span class="sc">|</span>       </span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>m_betagate <span class="sc">|</span> <span class="sc">-</span><span class="fl">159.76</span> <span class="sc">|</span> <span class="fl">7.21</span> <span class="sc">|</span>  <span class="fl">79.88</span> <span class="sc">|</span>    <span class="sc">-</span><span class="fl">305.45</span> <span class="sc">|</span>         <span class="fl">16.68</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>m_zoib     <span class="sc">|</span> <span class="sc">-</span><span class="fl">159.73</span> <span class="sc">|</span> <span class="fl">7.00</span> <span class="sc">|</span>  <span class="fl">79.86</span> <span class="sc">|</span>    <span class="sc">-</span><span class="fl">305.46</span> <span class="sc">|</span>         <span class="fl">16.99</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>m_xbx      <span class="sc">|</span> <span class="sc">-</span><span class="fl">145.03</span> <span class="sc">|</span> <span class="fl">5.11</span> <span class="sc">|</span>  <span class="fl">72.51</span> <span class="sc">|</span>    <span class="sc">-</span><span class="fl">312.81</span> <span class="sc">|</span>         <span class="fl">16.81</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span></code></pre></div>
<p>Running posterior predictive checks allows to visualize the predicted distributions from various models. We can see how typical Beta-related models fail to capture the bimodal nature of the data, which is well captured by the CHOCO model.</p>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_zoib</span>, keep_iterations <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"ZOIB"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_xbx</span>, keep_iterations <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"XBX"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_betagate</span>, keep_iterations <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"Beta-Gate"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_choco</span>, keep_iterations <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"CHOCO"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/get_data.html" class="external-link">get_data</a></span><span class="op">(</span><span class="va">m_zoib</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">100</span>, fill <span class="op">=</span> <span class="st">"#2196F3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rating Distribution"</span>, x <span class="op">=</span> <span class="st">"Score"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">pred</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iter_value</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">iter_group</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    bins <span class="op">=</span> <span class="fl">100</span>, alpha <span class="op">=</span> <span class="fl">0.02</span>, position <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"#FF5722"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Model</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="reference/figures/unnamed-chunk-12-1.png"></p>
</div>
<div class="section level4">
<h4 id="effect-visualisation">Effect Visualisation<a class="anchor" aria-label="anchor" href="#effect-visualisation"></a>
</h4>
<p>We can see how the predicted distribution changes as a function of <strong>x</strong> and gets “pushed” to the right. Moreover, we can also visualize the effect of <strong>x</strong> on specific parameters, showing that it mostly affects the parameter <strong>conf</strong> (the mean confidence - i.e., central tendency - on the right side), <strong>confleft</strong> (the relative confidence of the left side), and <strong>mu</strong>, which corresponds to the <strong><em>p</em></strong> probability of answering on the right. This is consistent with our expectations, and reflects the larger and more concentrated mass on the right of the scale for higher value of <strong>x</strong> (in brown).</p>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span><span class="va">m_choco</span>, data <span class="op">=</span> <span class="st">"grid"</span>, length <span class="op">=</span> <span class="fl">4</span>, keep_iterations <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iter_value</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span>, bins <span class="op">=</span> <span class="fl">100</span>, position <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_bluebrown_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict various parameters</span></span>
<span><span class="va">pred_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">param</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expectation"</span>, <span class="st">"confright"</span>, <span class="st">"confleft"</span>, <span class="st">"precright"</span>, <span class="st">"precleft"</span>, <span class="st">"pex"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pred_params</span> <span class="op">&lt;-</span> <span class="va">m_choco</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">modelbased</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/modelbased/reference/estimate_expectation.html" class="external-link">estimate_prediction</a></span><span class="op">(</span>data <span class="op">=</span> <span class="st">"grid"</span>, length <span class="op">=</span> <span class="fl">20</span>, predict <span class="op">=</span> <span class="va">param</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Parameter <span class="op">=</span> <span class="va">param</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># TODO: replace by data_modify after PR</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pred_params</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">pred_params</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">CI_low</span>, ymax <span class="op">=</span> <span class="va">CI_high</span>, fill <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Parameter</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span></span></code></pre></div>
</details><p><img src="reference/figures/unnamed-chunk-13-1.png"></p>
</div>
</div>
<div class="section level3">
<h3 id="cognitive-tasks">Cognitive Tasks<a class="anchor" aria-label="anchor" href="#cognitive-tasks"></a>
</h3>
<div class="section level4">
<h4 id="simulate-data-1">Simulate Data<a class="anchor" aria-label="anchor" href="#simulate-data-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rlnr.html">rlnr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3000</span>, nuzero <span class="op">=</span> <span class="fl">0.2</span>, nuone <span class="op">=</span> <span class="fl">0</span>, sigmazero <span class="op">=</span> <span class="fl">0.8</span>, sigmaone <span class="op">=</span> <span class="fl">0.5</span>, ndt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_match.html" class="external-link">data_filter</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.8</span>, position <span class="op">=</span> <span class="st">"identity"</span>, bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RT Distribution"</span>, x <span class="op">=</span> <span class="st">"Reaction Time"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span>, fill <span class="op">=</span> <span class="st">"Choice"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#009688"</span>, <span class="st">"#E91E63"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-14-1.png"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfcorrect</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="fl">0</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rt-only-models">RT-only Models<a class="anchor" aria-label="anchor" href="#rt-only-models"></a>
</h4>
<p>We are going to start with models that only predict the reaction time, and ignore the choice. Note that we only use the data from the correct trials (i.e., the ones with <code>response == 0</code>).</p>
<div class="section level5">
<h5 id="normal">Normal<a class="anchor" aria-label="anchor" href="#normal"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_normal</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_normal</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_normal</span>, file <span class="op">=</span> <span class="st">"man/figures/m_normal.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="exgaussian">ExGaussian<a class="anchor" aria-label="anchor" href="#exgaussian"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">beta</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">exgaussian</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_exgauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link">exgaussian</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_exgauss</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_exgauss</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_exgauss</span>, file <span class="op">=</span> <span class="st">"man/figures/m_exgauss.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="shifted-lognormal">Shifted LogNormal<a class="anchor" aria-label="anchor" href="#shifted-lognormal"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">dfcorrect</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rt_lognormal.html">rt_lognormal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_lognormal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rt_lognormal.html">rt_lognormal_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_lognormal</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_lognormal</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_lognormal</span>, file <span class="op">=</span> <span class="st">"man/figures/m_lognormal.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="inverse-gaussian-shifted-wald">Inverse Gaussian (Shifted Wald)<a class="anchor" aria-label="anchor" href="#inverse-gaussian-shifted-wald"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">bs</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rrt_invgaussian.html">rt_invgaussian</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_wald</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rrt_invgaussian.html">rt_invgaussian_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_wald</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_wald</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_wald</span>, file <span class="op">=</span> <span class="st">"man/figures/m_wald.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="weibull">Weibull<a class="anchor" aria-label="anchor" href="#weibull"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rt_weibull.html">rt_weibull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_weibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rt_weibull.html">rt_weibull_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_weibull</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_weibull</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_weibull</span>, file <span class="op">=</span> <span class="st">"man/figures/m_weibull.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="logweibull-shifted-gumbel">LogWeibull (Shifted Gumbel)<a class="anchor" aria-label="anchor" href="#logweibull-shifted-gumbel"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rt_logweibull.html">rt_logweibull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_logweibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rt_logweibull.html">rt_logweibull_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_logweibull</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_logweibull</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_logweibull</span>, file <span class="op">=</span> <span class="st">"man/figures/m_logweibull.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="inverse-weibull-shifted-fréchet">Inverse Weibull (Shifted Fréchet)<a class="anchor" aria-label="anchor" href="#inverse-weibull-shifted-fr%C3%A9chet"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rt_invweibull.html">rt_invweibull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_invweibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rt_invweibull.html">rt_invweibull_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_invweibull</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_invweibull</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_invweibull</span>, file <span class="op">=</span> <span class="st">"man/figures/m_invweibull.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="gamma">Gamma<a class="anchor" aria-label="anchor" href="#gamma"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rt_gamma.html">rt_gamma</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rt_gamma.html">rt_gamma_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_gamma</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_gamma</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_gamma</span>, file <span class="op">=</span> <span class="st">"man/figures/m_gamma.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="inverse-gamma">Inverse Gamma<a class="anchor" aria-label="anchor" href="#inverse-gamma"></a>
</h5>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rt_invgamma.html">rt_invgamma</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">dfcorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_invgamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dfcorrect</span>, </span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rt_invgamma.html">rt_invgamma_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_invgamma</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_invgamma</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_invgamma</span>, file <span class="op">=</span> <span class="st">"man/figures/m_invgamma.rds"</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level5">
<h5 id="model-comparison-1">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison-1"></a>
</h5>
<p>We can compare these models together using the <code>loo</code> package, which shows that CHOCO provides a significantly better fit than the other models.</p>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_normal.rds"</span><span class="op">)</span></span>
<span><span class="va">m_exgauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_exgauss.rds"</span><span class="op">)</span></span>
<span><span class="va">m_lognormal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_lognormal.rds"</span><span class="op">)</span></span>
<span><span class="va">m_wald</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_wald.rds"</span><span class="op">)</span></span>
<span><span class="va">m_weibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_wald.rds"</span><span class="op">)</span></span>
<span><span class="va">m_logweibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_logweibull.rds"</span><span class="op">)</span></span>
<span><span class="va">m_invweibull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_invweibull.rds"</span><span class="op">)</span></span>
<span><span class="va">m_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_gamma.rds"</span><span class="op">)</span></span>
<span><span class="va">m_invgamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_invgamma.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">m_normal</span>, <span class="va">m_exgauss</span>, <span class="va">m_lognormal</span>, <span class="va">m_wald</span>, </span>
<span>                 <span class="va">m_weibull</span>, <span class="va">m_logweibull</span>, <span class="va">m_invweibull</span>,</span>
<span>                 <span class="va">m_gamma</span>, <span class="va">m_invgamma</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parameters</span><span class="op">(</span>include_ENP <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Fixed Effects</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>Name         <span class="sc">|</span>   LOOIC <span class="sc">|</span>  ENP <span class="sc">|</span>     ELPD <span class="sc">|</span> Difference <span class="sc">|</span> Difference_SE <span class="sc">|</span>      p</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="sc">------------------------------------------------------------------------------</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>m_wald       <span class="sc">|</span>  <span class="fl">941.45</span> <span class="sc">|</span> <span class="fl">2.83</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">470.73</span> <span class="sc">|</span>       <span class="fl">0.00</span> <span class="sc">|</span>          <span class="fl">0.00</span> <span class="sc">|</span>       </span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>m_weibull    <span class="sc">|</span>  <span class="fl">941.45</span> <span class="sc">|</span> <span class="fl">2.83</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">470.73</span> <span class="sc">|</span>       <span class="fl">0.00</span> <span class="sc">|</span>          <span class="fl">0.00</span> <span class="sc">|</span>       </span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>m_lognormal  <span class="sc">|</span>  <span class="fl">942.34</span> <span class="sc">|</span> <span class="fl">2.92</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">471.17</span> <span class="sc">|</span>      <span class="sc">-</span><span class="fl">0.44</span> <span class="sc">|</span>          <span class="fl">1.27</span> <span class="sc">|</span> <span class="fl">0.726</span> </span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>m_invgamma   <span class="sc">|</span>  <span class="fl">957.25</span> <span class="sc">|</span> <span class="fl">2.17</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">478.63</span> <span class="sc">|</span>      <span class="sc">-</span><span class="fl">7.90</span> <span class="sc">|</span>          <span class="fl">3.94</span> <span class="sc">|</span> <span class="fl">0.045</span> </span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>m_gamma      <span class="sc">|</span>  <span class="fl">957.27</span> <span class="sc">|</span> <span class="fl">2.83</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">478.64</span> <span class="sc">|</span>      <span class="sc">-</span><span class="fl">7.91</span> <span class="sc">|</span>          <span class="fl">4.11</span> <span class="sc">|</span> <span class="fl">0.054</span> </span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>m_exgauss    <span class="sc">|</span>  <span class="fl">960.26</span> <span class="sc">|</span> <span class="fl">2.74</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">480.13</span> <span class="sc">|</span>      <span class="sc">-</span><span class="fl">9.41</span> <span class="sc">|</span>          <span class="fl">4.08</span> <span class="sc">|</span> <span class="fl">0.021</span> </span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>m_invweibull <span class="sc">|</span> <span class="fl">1100.95</span> <span class="sc">|</span> <span class="fl">2.39</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">550.47</span> <span class="sc">|</span>     <span class="sc">-</span><span class="fl">79.75</span> <span class="sc">|</span>         <span class="fl">11.04</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>m_normal     <span class="sc">|</span> <span class="fl">1578.76</span> <span class="sc">|</span> <span class="fl">4.16</span> <span class="sc">|</span>  <span class="sc">-</span><span class="fl">789.38</span> <span class="sc">|</span>    <span class="sc">-</span><span class="fl">318.65</span> <span class="sc">|</span>         <span class="fl">31.17</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>m_logweibull <span class="sc">|</span> <span class="fl">2628.31</span> <span class="sc">|</span> <span class="fl">1.02</span> <span class="sc">|</span> <span class="sc">-</span><span class="fl">1314.15</span> <span class="sc">|</span>    <span class="sc">-</span><span class="fl">843.43</span> <span class="sc">|</span>         <span class="fl">25.27</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span></code></pre></div>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># `iterations` controls the actual number of iterations used (e.g., for the point-estimate)</span></span>
<span><span class="co"># and `keep_iterations` the number included.</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_normal</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"Normal"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_exgauss</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"ExGaussian"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_lognormal</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"LogNormal"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_wald</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"InvGaussian"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_weibull</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"Weibull"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Fréchet and Gumbel have a very heavy right tail, and can produce very large values</span></span>
<span>  <span class="co"># Hence we need to truncate the draws</span></span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_logweibull</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"LogWeibull"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">data_filter</span><span class="op">(</span><span class="va">iter_value</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_invweibull</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"InvWeibull"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">data_filter</span><span class="op">(</span><span class="va">iter_value</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_gamma</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"Gamma"</span><span class="op">)</span>,</span>
<span>  <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_invgamma</span>, keep_iterations <span class="op">=</span> <span class="fl">100</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">data_modify</span><span class="op">(</span>Model <span class="op">=</span> <span class="st">"InvGamma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">iter_value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="fl">0</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">rt</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"black"</span>, bins<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">Model</span>, group<span class="op">=</span><span class="va">iter_group</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"density"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Model</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">see</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/see/reference/scale_color_material.html" class="external-link">scale_color_material_d</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="reference/figures/unnamed-chunk-25-1.png"></p>
</div>
</div>
<div class="section level4">
<h4 id="decision-making-choice--rt">Decision Making (Choice + RT)<a class="anchor" aria-label="anchor" href="#decision-making-choice--rt"></a>
</h4>
<div class="section level5">
<h5 id="drift-diffusion-model-ddm">Drift Diffusion Model (DDM)<a class="anchor" aria-label="anchor" href="#drift-diffusion-model-ddm"></a>
</h5>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">|</span> <span class="fu">dec</span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">bs</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">bias</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rddm.html">ddm</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_ddm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rddm.html">ddm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rddm.html">ddm_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_ddm</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_ddm</span>, <span class="st">"loo"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_ddm</span>, file <span class="op">=</span> <span class="st">"man/figures/m_ddm.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="linear-ballistic-accumulator-lba">Linear Ballistic Accumulator (LBA)<a class="anchor" aria-label="anchor" href="#linear-ballistic-accumulator-lba"></a>
</h5>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">|</span> <span class="fu">dec</span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">vdelta</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigmazero</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigmadelta</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">A</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  <span class="va">k</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rlba.html">lba</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"tau"</span><span class="op">)</span>,</span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span>,</span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"k"</span><span class="op">)</span>,</span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"vdelta"</span><span class="op">)</span>,</span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0, 1)"</span>, class <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"sigmazero"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">m_lba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rlba.html">lba</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rlba.html">lba_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_lba</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_lba</span>, <span class="st">"loo"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_lba</span>, file <span class="op">=</span> <span class="st">"man/figures/m_lba.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="lognormal-race-lnr">LogNormal Race (LNR)<a class="anchor" aria-label="anchor" href="#lognormal-race-lnr"></a>
</h5>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span></span>
<span>  <span class="va">rt</span> <span class="op">|</span> <span class="fu">dec</span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">nuone</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigmazero</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">sigmaone</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  <span class="va">tau</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  minrt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rlnr.html">lnr</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_lnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">f</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  init <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="reference/rlnr.html">lnr</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stanvars <span class="op">=</span> <span class="fu"><a href="reference/rlnr.html">lnr_stanvars</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">500</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_lnr</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/add_criterion.html" class="external-link">add_criterion</a></span><span class="op">(</span><span class="va">m_lnr</span>, <span class="st">"loo"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">m_lnr</span>, file <span class="op">=</span> <span class="st">"man/figures/m_lnr.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="model-comparison-2">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison-2"></a>
</h5>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_ddm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_ddm.rds"</span><span class="op">)</span></span>
<span><span class="va">m_lnr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"man/figures/m_lnr.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">m_ddm</span>, <span class="va">m_lnr</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parameters</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html" class="external-link">parameters</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Fixed Effects</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>Name  <span class="sc">|</span>   LOOIC <span class="sc">|</span>     ELPD <span class="sc">|</span> Difference <span class="sc">|</span> Difference_SE <span class="sc">|</span>      p</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="sc">----------------------------------------------------------------</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>m_lnr <span class="sc">|</span> <span class="fl">6048.62</span> <span class="sc">|</span> <span class="sc">-</span><span class="fl">3024.31</span> <span class="sc">|</span>       <span class="fl">0.00</span> <span class="sc">|</span>          <span class="fl">0.00</span> <span class="sc">|</span>       </span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>m_ddm <span class="sc">|</span> <span class="fl">6805.52</span> <span class="sc">|</span> <span class="sc">-</span><span class="fl">3402.76</span> <span class="sc">|</span>    <span class="sc">-</span><span class="fl">378.45</span> <span class="sc">|</span>         <span class="fl">33.57</span> <span class="sc">|</span> <span class="er">&lt;</span> .<span class="dv">001</span></span></code></pre></div>
<details class="code-fold"><summary>
Code
</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">estimate_prediction</span><span class="op">(</span><span class="va">m_lnr</span>, data <span class="op">=</span> <span class="va">df</span>, iterations <span class="op">=</span> <span class="fl">100</span>, keep_iterations <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">reshape_iterations</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/extract_column_names.html" class="external-link">data_select</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Row"</span>, <span class="st">"Component"</span>, <span class="st">"iter_value"</span>, <span class="st">"iter_group"</span>, <span class="st">"iter_index"</span><span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_to_wide.html" class="external-link">data_to_wide</a></span><span class="op">(</span>id_cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Row"</span>, <span class="st">"iter_group"</span><span class="op">)</span>, values_from<span class="op">=</span><span class="st">"iter_value"</span>, names_from<span class="op">=</span><span class="st">"Component"</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_match.html" class="external-link">data_filter</a></span><span class="op">(</span><span class="va">pred</span>, <span class="st">"rt &lt; 4"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">.density_rt_response</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rt</span>, <span class="va">response</span>, <span class="va">length.out</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rt_choice0</span> <span class="op">&lt;-</span> <span class="va">rt</span><span class="op">[</span><span class="va">response</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">rt_choice1</span> <span class="op">&lt;-</span> <span class="va">rt</span><span class="op">[</span><span class="va">response</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">xaxis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rt_choice0</span>, <span class="va">rt_choice1</span><span class="op">)</span><span class="op">*</span> <span class="fl">1.1</span>, length.out <span class="op">=</span> <span class="va">length.out</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/check_if_installed.html" class="external-link">check_if_installed</a></span><span class="op">(</span><span class="st">"logspline"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xaxis</span>, </span>
<span>               y <span class="op">=</span> <span class="fu">logspline</span><span class="fu">::</span><span class="fu">dlogspline</span><span class="op">(</span><span class="va">xaxis</span>, <span class="fu">logspline</span><span class="fu">::</span><span class="fu">logspline</span><span class="op">(</span><span class="va">rt_choice0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               response <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xaxis</span>,</span>
<span>               y <span class="op">=</span> <span class="op">-</span><span class="fu">logspline</span><span class="fu">::</span><span class="fu">dlogspline</span><span class="op">(</span><span class="va">xaxis</span>, <span class="fu">logspline</span><span class="fu">::</span><span class="fu">logspline</span><span class="op">(</span><span class="va">rt_choice1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               response <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">density_rt_response</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">rt</span><span class="op">=</span><span class="st">"rt"</span>, <span class="va">response</span><span class="op">=</span><span class="st">"response"</span>, <span class="va">by</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">length.out</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">by</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">.density_rt_response</span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">rt</span><span class="op">]</span><span class="op">]</span>, <span class="va">data</span><span class="op">[[</span><span class="va">response</span><span class="op">]</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">length.out</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">data</span><span class="op">[[</span><span class="va">by</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">.density_rt_response</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="va">rt</span><span class="op">]</span><span class="op">]</span>, <span class="va">x</span><span class="op">[[</span><span class="va">response</span><span class="op">]</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">length.out</span><span class="op">)</span></span>
<span>      <span class="va">d</span><span class="op">[[</span><span class="va">by</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[[</span><span class="va">by</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">d</span></span>
<span>      <span class="op">}</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">out</span><span class="op">)</span></span>
<span>    <span class="va">out</span><span class="op">[[</span><span class="va">by</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="va">by</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span><span class="op">[[</span><span class="va">response</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">out</span><span class="op">[[</span><span class="va">response</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span>  </span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">density_rt_response</span><span class="op">(</span><span class="va">pred</span>, rt<span class="op">=</span><span class="st">"rt"</span>, response<span class="op">=</span><span class="st">"response"</span>, by<span class="op">=</span><span class="st">"iter_group"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="fl">0</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"darkgreen"</span>, bins<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">response</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="op">-</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"darkred"</span>, bins<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color <span class="op">=</span> <span class="va">response</span>, group <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">iter_group</span><span class="op">)</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="reference/figures/unnamed-chunk-30-1.png"></p>
</div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/DominiqueMakowski/cogmod/">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing cogmod</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dominique Makowski <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5375-9967" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dominique Makowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
